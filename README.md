# DramaGen AI

> æ™ºèƒ½åŒ–çŸ­å‰§è§†é¢‘ç”Ÿäº§å·¥å…· - ä»åŸå§‹é•¿è§†é¢‘åˆ°é«˜ç‚¹å‡»çŸ­è§†é¢‘çš„è‡ªåŠ¨åŒ–/åŠè‡ªåŠ¨åŒ–äº§å‡º

[![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue)](https://www.typescriptlang.org/)
[![Next.js](https://img.shields.io/badge/Next.js-15.1-black)](https://nextjs.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

DramaGen AI æ˜¯ä¸€æ¬¾é¢å‘çŸ­å‰§/æ¼«å‰§å‰ªè¾‘å¸ˆã€æŠ•æ”¾è¿è¥åŠè‡ªåª’ä½“åšä¸»çš„æ™ºèƒ½åŒ–è§†é¢‘ç”Ÿäº§å·¥å…·ã€‚ç³»ç»Ÿæ·±åº¦é›†æˆ **Gemini 3** çš„å¤šæ¨¡æ€ç†è§£èƒ½åŠ›ï¼Œå®ç°ä»åŸå§‹é•¿è§†é¢‘åˆ°é«˜ç‚¹å‡»çŸ­è§†é¢‘çš„è‡ªåŠ¨åŒ–äº§å‡ºã€‚

### æ ¸å¿ƒåŠŸèƒ½

#### ğŸ¬ æ¨¡å¼ Aï¼šé«˜å…‰æ™ºèƒ½åˆ‡ç‰‡
è‡ªåŠ¨è¯†åˆ«å¹¶æå–è§†é¢‘ä¸­çš„ç—…æ¯’ä¼ æ’­æ—¶åˆ»ï¼Œæ”¯æŒæ¯«ç§’çº§ç²¾åº¦è°ƒæ•´
- AI æ£€æµ‹ç—…æ¯’å¼ä¼ æ’­æ¡¥æ®µï¼ˆåè½¬ã€èº«ä»½æ›å…‰ã€å†²çªçˆ†å‘ï¼‰
- æ¯«ç§’çº§æ‰‹åŠ¨å¾®è°ƒï¼ˆÂ±100msã€Â±500msã€Â±1000msï¼‰
- åˆ‡ç‚¹å®æ—¶é¢„è§ˆ
- å¸§çº§ç²¾ç¡®åˆ‡å‰²

#### ğŸ™ï¸ æ¨¡å¼ Bï¼šæ·±åº¦è§£è¯´çŸ©é˜µ
ä»æ•…äº‹çº¿ç”Ÿæˆå¤šç‰ˆæœ¬è§£è¯´æ–‡æ¡ˆï¼Œè‡ªåŠ¨å®ç°éŸ³ç”»åŒ¹é…
- æå– â‰¥10 æ¡ç‹¬ç«‹æ•…äº‹çº¿
- ç”Ÿæˆå¤šç§è§£è¯´é£æ ¼ï¼ˆæ‚¬å¿µé’©å­ç‰ˆã€åæ§½ç‰ˆã€æƒ…ç»ªå…±é¸£ç‰ˆï¼‰
- TTS åˆæˆ + è¯­ä¹‰ç”»é¢åŒ¹é…
- å››è½¨éŸ³é¢‘æ··éŸ³ï¼ˆè§£è¯´ + åŸéŸ³ + BGMï¼‰

---

## âœ¨ å½“å‰çŠ¶æ€

**ç‰ˆæœ¬**: v0.1.0  
**æ›´æ–°æ—¶é—´**: 2025-02-08

### å·²å®Œæˆ âœ…

| æ¨¡å— | çŠ¶æ€ | å®Œæˆåº¦ |
|------|------|--------|
| **ç´ æç®¡ç†** | âœ… å®Œæˆ | 100% |
| - é¡¹ç›®ç®¡ç†ï¼ˆCRUD + æœç´¢ï¼‰ | âœ… | 100% |
| - è§†é¢‘ç®¡ç†ï¼ˆä¸Šä¼  + åˆ é™¤ï¼‰ | âœ… | 100% |
| - **è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹** | âœ… | 100% |
| - ä»»åŠ¡é˜Ÿåˆ—ç³»ç»Ÿ | âœ… | 100% |
| - æ•°æ®å±‚æ¶æ„ | âœ… | 100% |

### å¾…å¼€å‘ ğŸš§

| æ¨¡å— | çŠ¶æ€ | å®Œæˆåº¦ |
|------|------|--------|
| **é«˜å…‰åˆ‡ç‰‡æ¨¡å¼** | ğŸš§ å¼€å‘ä¸­ | 20% |
| **æ·±åº¦è§£è¯´æ¨¡å¼** | â³ å¾…å¼€å‘ | 0% |
| **ä»»åŠ¡ç®¡ç† UI** | â³ å¾…å¼€å‘ | 0% |

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Next.js 15 (App Router)
- **è¯­è¨€**: TypeScript 5.0
- **æ ·å¼**: Tailwind CSS
- **UI ç»„ä»¶**: shadcn/ui (Radix UI)
- **åŠ¨ç”»**: Framer Motion
- **çŠ¶æ€ç®¡ç†**: React Hooks

### åç«¯
- **æ¡†æ¶**: Next.js 15 (API Routes)
- **æ•°æ®åº“**: SQLite + Drizzle ORM
- **ä»»åŠ¡é˜Ÿåˆ—**: BullMQ + Redis
- **å®æ—¶é€šä¿¡**: WebSocket (ws)
- **è§†é¢‘å¤„ç†**: FFmpeg (fluent-ffmpeg)

### AI æœåŠ¡
- **è§†é¢‘åˆ†æ**: Gemini 3
- **è¯­éŸ³åˆæˆ**: ElevenLabs TTS

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- Redis >= 6.0
- FFmpeg >= 5.0

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```env
# Gemini API
GEMINI_API_KEY=your_gemini_api_key
YUNWU_API_ENDPOINT=https://your_yunwu_endpoint

# ElevenLabs API
ELEVENLABS_API_KEY=your_elevenlabs_api_key

# Redis
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# åº”ç”¨é…ç½®
NODE_ENV=development
PORT=3000
```

### åˆå§‹åŒ–æ•°æ®åº“

```bash
npm run db:push
```

### å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼ï¼ˆå¯åŠ¨ Next.js + Workersï¼‰
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm run start

# ç‹¬ç«‹å¯åŠ¨ Workers
npm run workers
npm run workers:dev  # å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
```

### è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
dramagen-ai/
â”œâ”€â”€ app/                      # Next.js App Router
â”‚   â”œâ”€â”€ projects/            # é¡¹ç›®ç®¡ç†é¡µé¢
â”‚   â”‚   â”œâ”€â”€ page.tsx         # é¡¹ç›®åˆ—è¡¨
â”‚   â”‚   â””â”€â”€ [id]/            # é¡¹ç›®è¯¦æƒ…
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â””â”€â”€ api/                 # API è·¯ç”±
â”‚       â”œâ”€â”€ projects/        # é¡¹ç›® API
â”‚       â”œâ”€â”€ videos/          # è§†é¢‘ API
â”‚       â””â”€â”€ upload/          # æ–‡ä»¶ä¸Šä¼  API
â”‚
â”œâ”€â”€ components/              # React ç»„ä»¶
â”‚   â”œâ”€â”€ ui/                  # shadcn/ui ç»„ä»¶
â”‚   â”œâ”€â”€ create-project-dialog.tsx
â”‚   â”œâ”€â”€ edit-project-dialog.tsx
â”‚   â””â”€â”€ upload-video-dialog.tsx
â”‚
â”œâ”€â”€ lib/                     # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ api/                 # API å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ gemini.ts        # Gemini å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ elevenlabs.ts    # ElevenLabs å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ db/                  # æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ schema.ts        # Drizzle Schema
â”‚   â”‚   â”œâ”€â”€ client.ts        # SQLite å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ queries.ts       # æŸ¥è¯¢æ¥å£
â”‚   â”œâ”€â”€ queue/               # ä»»åŠ¡é˜Ÿåˆ—
â”‚   â”‚   â”œâ”€â”€ bullmq.ts        # BullMQ ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ workers.ts       # Worker å¤„ç†å™¨
â”‚   â”œâ”€â”€ ws/                  # WebSocket
â”‚   â”‚   â””â”€â”€ server.ts        # WebSocket æœåŠ¡å™¨
â”‚   â””â”€â”€ server.ts            # è‡ªå®šä¹‰æœåŠ¡å™¨
â”‚
â”œâ”€â”€ scripts/                 # è„šæœ¬
â”‚   â””â”€â”€ workers.ts           # Worker å¯åŠ¨è„šæœ¬
â”‚
â””â”€â”€ uploads/                 # æ–‡ä»¶ä¸Šä¼ ç›®å½•
```

---

## ğŸ”‘ æ ¸å¿ƒåŠŸèƒ½

### 1. ç´ æç®¡ç†

#### é¡¹ç›®ç®¡ç†
- åˆ›å»ºé¡¹ç›®ï¼ˆåç§° + æè¿°ï¼‰
- ç¼–è¾‘é¡¹ç›®ä¿¡æ¯
- åˆ é™¤é¡¹ç›®ï¼ˆçº§è”åˆ é™¤æ‰€æœ‰è§†é¢‘ï¼‰
- æœç´¢é¡¹ç›®ï¼ˆå®æ—¶æœç´¢ï¼‰

#### è§†é¢‘ç®¡ç†
- ä¸Šä¼ è§†é¢‘ï¼ˆæ”¯æŒå¤šæ–‡ä»¶ï¼‰
- åˆ é™¤è§†é¢‘ï¼ˆç‰©ç†æ–‡ä»¶ + æ•°æ®åº“è®°å½•ï¼‰
- æŸ¥çœ‹è§†é¢‘å…ƒæ•°æ®ï¼ˆæ—¶é•¿ã€åˆ†è¾¨ç‡ã€å¸§ç‡ç­‰ï¼‰

#### è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹ â­

```mermaid
graph LR
    A[ä¸Šä¼ è§†é¢‘] --> B[ä¿å­˜æ–‡ä»¶]
    B --> C[åˆ›å»ºè®°å½•<br/>status: uploading]
    C --> D[è§¦å‘ä»»åŠ¡é˜Ÿåˆ—]
    D --> E[é•œå¤´æ£€æµ‹<br/>status: processing]
    E --> F[Gemini åˆ†æ<br/>status: analyzing]
    F --> G[å°±ç»ª<br/>status: ready]
```

**æŠ€æœ¯å®ç°**ï¼š
- å¼‚æ­¥éé˜»å¡è®¾è®¡ï¼ˆä¸Šä¼  API ç«‹å³è¿”å›ï¼‰
- ä»»åŠ¡é˜Ÿåˆ—è‡ªåŠ¨å¤„ç†ï¼ˆBullMQ + Redisï¼‰
- çŠ¶æ€æœºç®¡ç†ï¼ˆuploading â†’ processing â†’ analyzing â†’ readyï¼‰
- å®æ—¶è¿›åº¦æ¨é€ï¼ˆWebSocketï¼‰

---

## ğŸ“Š æ•°æ®åº“æ¶æ„

### è¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | å­—æ®µæ•° |
|------|------|--------|
| `projects` | é¡¹ç›®ä¿¡æ¯ | 8 |
| `videos` | è§†é¢‘ä¿¡æ¯ | 13 |
| `shots` | é•œå¤´åˆ‡ç‰‡ | 13 |
| `storylines` | æ•…äº‹çº¿ | 7 |
| `highlights` | é«˜å…‰å€™é€‰ | 8 |
| `recap_tasks` | è§£è¯´ä»»åŠ¡ | 7 |
| `recap_segments` | è§£è¯´ç‰‡æ®µ | 7 |
| `queue_jobs` | é˜Ÿåˆ—ä»»åŠ¡è®°å½• | 8 |

### å…³ç³»

```
projects (1) â”€â”€â”€â”€< (N) videos (1) â”€â”€â”€â”€< (N) shots
                                 â”‚
                                 â”œâ”€â”€> (N) highlights
                                 â”‚
storylines (1) â”€â”€â”€â”€< (N) recap_tasks (1) â”€â”€â”€â”€< (N) recap_segments
     â”‚                                    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€< videos â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### ä»»åŠ¡é˜Ÿåˆ—é…ç½®

```typescript
// lib/config/index.ts
export const queueConfig = {
  redis: {
    host: 'localhost',
    port: 6379,
    password: undefined,
    db: 0,
  },
  maxConcurrentJobs: 3,
  retryAttempts: 3,
  retryDelay: 5000,
  queues: {
    videoProcessing: 'video-processing',
    geminiAnalysis: 'gemini-analysis',
    ttsGeneration: 'tts-generation',
    videoRender: 'video-render',
  },
};
```

### WebSocket é…ç½®

```typescript
export const wsConfig = {
  port: 3001,
  heartbeatInterval: 30000,
  maxConnections: 100,
};
```

---

## ğŸ“š API æ–‡æ¡£

### é¡¹ç›®ç®¡ç†

```
GET    /api/projects              # è·å–é¡¹ç›®åˆ—è¡¨
POST   /api/projects              # åˆ›å»ºé¡¹ç›®
GET    /api/projects/:id          # è·å–é¡¹ç›®è¯¦æƒ…
PUT    /api/projects/:id          # æ›´æ–°é¡¹ç›®
DELETE /api/projects/:id          # åˆ é™¤é¡¹ç›®
GET    /api/projects/search?q=å…³é”®è¯  # æœç´¢é¡¹ç›®
```

### è§†é¢‘ç®¡ç†

```
GET    /api/projects/:id/videos   # è·å–é¡¹ç›®è§†é¢‘åˆ—è¡¨
POST   /api/projects/:id/videos   # ä¸Šä¼ è§†é¢‘
DELETE /api/videos/:id            # åˆ é™¤è§†é¢‘
POST   /api/upload                # æ–‡ä»¶ä¸Šä¼ ï¼ˆå¸¦å…ƒæ•°æ®æå–ï¼‰
```

---

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
npm test

# è¿è¡Œæµ‹è¯•ï¼ˆç›‘å¬æ¨¡å¼ï¼‰
npm run test:watch

# æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

---

## ğŸ“– æ–‡æ¡£

- **[é¡¹ç›®çŠ¶æ€æ€»è§ˆ](PROJECT-STATUS.md)** - åŠŸèƒ½å®Œæˆåº¦å’ŒæŠ€æœ¯æ¶æ„
- **[Agent 4 æŒ‡å—](AGENT-4-GUIDE.md)** - æ•°æ®å±‚å¼€å‘æŒ‡å—
- **[è‡ªåŠ¨åŒ–å¤„ç†æµç¨‹](AGENT-4-AUTO-PROCESSING-PIPELINE.md)** - ä»»åŠ¡é˜Ÿåˆ—è¯¦è§£
- **[åä½œæ–‡æ¡£](COLLABORATION.md)** - Agent åä½œæœºåˆ¶
- **[éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md)** - éƒ¨ç½²è¯´æ˜

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·å…ˆæŸ¥çœ‹ [CLAUDE.md](CLAUDE.md) äº†è§£é¡¹ç›®è§„èŒƒã€‚

### å¼€å‘æµç¨‹

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

---

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org/)
- [Drizzle ORM](https://orm.drizzle.team/)
- [BullMQ](https://docs.bullmq.io/)
- [shadcn/ui](https://ui.shadcn.com/)
- [Gemini](https://ai.google.dev/)
- [ElevenLabs](https://elevenlabs.io/)

---

**Made with â¤ï¸ by DramaGen AI Team**
